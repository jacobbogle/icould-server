<!DOCTYPE html>
<html>
<head>
    <title>iCloud Audio Server</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background: #f0f0f0; padding: 10px; border-bottom: 1px solid #ccc; }
        .tabs { display: flex; border-bottom: 1px solid #ccc; }
        .tab { padding: 10px 20px; cursor: pointer; background: #f1f1f1; border: 1px solid #ccc; border-bottom: none; }
        .tab.active { background: white; border-bottom: 1px solid white; }
        .tab-content { display: none; padding: 20px; border: 1px solid #ccc; border-top: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div class="header">
        <h1>iCloud Audio Server - {{ directory or "root" }}</h1>
        <p>Logged in as: {{ username }}</p>
        {% if username == 'admin' %}
        <div style="float: right;">
            {% if icloud_authenticated %}
            <span style="color: green;">☁️ iCloud Connected</span>
            {% elif is_registered %}
            <span style="color: blue;">☁️ iCloud Registered Successfully</span>
            {% else %}
            <a href="/icloud_login" style="color: red;">☁️ iCloud Login Required</a>
            {% endif %}
        </div>
        {% endif %}
    </div>
    <div style="clear: both;"></div>
    
    <div class="tabs">
        <div class="tab active" onclick="showTab('files')">Audio Files</div>
        <div class="tab" onclick="showTab('sync')">Sync</div>
        <div class="tab" onclick="showTab('settings')">Settings</div>
        {% if username == 'admin' %}
        <div class="tab" onclick="showTab('users')">Users</div>
        {% endif %}
    </div>
    
    <div id="files" class="tab-content active">
        {% include 'tabs/_files_tab.html' %}
    </div>
    
    <div id="sync" class="tab-content">
        {% include 'tabs/_sync_tab.html' %}
    </div>
    
    <div id="settings" class="tab-content">
        {% include 'tabs/_settings_tab.html' %}
    </div>
    
    {% if username == 'admin' %}
    <div id="users" class="tab-content">
        {% include 'tabs/_users_tab.html' %}
    </div>
    {% endif %}
    
    <br><a href="/logout">Logout</a>
    
    <script>
        function showTab(tabId) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));
            document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }
    </script>
</body>
</html>